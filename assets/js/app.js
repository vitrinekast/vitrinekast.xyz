var screenController=function(){let e,n=[],v={snow:{},vcr:{opacity:1,miny:220,miny2:220,num:30,fps:60}};const t=(t=2)=>{if(!v.vcr)return!1;const e=v.vcr.canvas,n=v.vcr.ctx;let r=v.vcr.miny||0;var o=v.vcr.maxy||e.height;let a=v.vcr.miny2||0;var f=v.vcr.num||20,u=e.width;e.height;e.style.filter="blur(.1px)",n.clearRect(0,0,e.width,e.height),n.fillStyle="#fff",n.beginPath();for(var l=0;l<=f;l++){var c=Math.random(l)*u,i=getRandomInt(r+=3,o),s=getRandomInt(0,a-=3);n.fillRect(c,i,t,t),n.fillRect(c,s,t,t),n.fill(),d(n,c,i,t/5),d(n,c,s,t/5)}n.closePath()},d=(e,n,r,o)=>{var a=getRandomInt(1,50),t=[1,-1];let l=o;var c=t[Math.floor(Math.random()*t.length)];for(let t=0;t<a;t++){var i=getRandomInt(l-=.01,o),s=getRandomInt(1,4);o-=.1,s*=c,e.fillRect(n+=s,r,i,i),e.fill()}};function r(e){var t=n.filter(t=>l(t.link)===l(e));return 0!==t.length&&t[0]}function o(){c("off"),n.forEach(t=>{t.el.pause(),t.el.setAttribute("active","false")})}var i=t=>{if(!v.snow)return!1;for(var e=v.snow.ctx.canvas.width,n=v.snow.ctx.canvas.height,e=v.snow.ctx.createImageData(e,n),r=new Uint32Array(e.data.buffer),o=r.length,a=0;a<o;a++)r[a]=(255*Math.random()|0)<<24;v.snow.ctx.putImageData(e,0,0)},a=function(){i(),t(),requestAnimationFrame(a)},l=function(t){return(t=t.replace(/.+\/\/|www.|\..+/g,"")).toLowerCase()},c=function(t){e.classList.remove("on"),e.classList.remove("off"),e.classList.add(t)};return{init:function(){if(!(e=document.querySelectorAll(".fn-videoplayer")[0]))return!1;document.querySelectorAll(".fn-video").forEach(t=>{n.push({el:t,url:t.src,link:t.getAttribute("data-show-link"),isPlaying:!1})}),v.snow.canvas=document.querySelector(".fn-snow"),v.snow.ctx=v.snow.canvas.getContext("2d"),v.vcr.canvas=document.querySelector(".fn-vcr"),v.vcr.ctx=v.vcr.canvas.getContext("2d"),a()},playItem:function(t){o();let e=r(t);e&&(e.el.play(),e.el.setAttribute("active","true"),c("on"))},stopAllItems:o,getPlayableItem:r}}();function getRandomInt(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}var tvItemController=function(){const e=4e3;let n=!1,r=[],o=0;function a(){console.log("removeAllActiveStates"),r.forEach(t=>{t.classList.remove("active")})}function l(t){i(),screenController.playItem(this.getAttribute("href"))}function u(t){s(forceStop=!0)}var c,i=function(){a(),c.removeAttribute("active"),n=window.clearInterval(n)},s=function(t=!1){n||t?(i(),screenController.stopAllItems()):(c.setAttribute("active",!0),f(),n=window.setInterval(()=>{f()},e))},f=function(){a();var t=r[o];t.classList.add("active"),screenController.playItem(t.href),o===r.length-1?o=0:o++};return{init:function(){document.querySelectorAll("article a[rel]").forEach(t=>{screenController.getPlayableItem(t.href)&&(t.addEventListener("mouseenter",l),t.addEventListener("mouseleave",u),r.push(t))}),(c=document.querySelector(".fn-video-loop")).addEventListener("click",function(t){t.preventDefault(),s()})}}}();window.onload=function(){console.log("app.js loaded"),screenController.init(),tvItemController.init(),document.body.classList.add("js-loaded")};