var screenController=function(){const n="on",e="off",o="active";let r,a=[],d={snow:{},vcr:{opacity:1,miny:220,miny2:220,num:30,fps:60}};const t=(t=2)=>{if(!d.vcr)return!1;var e=d.vcr.canvas,n=d.vcr.ctx;let o=d.vcr.miny||0;var r=d.vcr.maxy||e.height;let a=d.vcr.miny2||0;var i=d.vcr.num||20,c=e.width;e.height;e.style.filter="blur(.1px)",n.clearRect(0,0,e.width,e.height),n.fillStyle="#fff",n.beginPath();for(var l=0;l<=i;l++){var s=Math.random(l)*c,u=getRandomInt(o+=3,r),v=getRandomInt(0,a-=3);n.fillRect(s,u,t,t),n.fillRect(s,v,t,t),n.fill(),f(n,s,u,t/5),f(n,s,v,t/5)}n.closePath()},f=(e,n,o,r)=>{var a=getRandomInt(1,50),t=[1,-1];let i=r;var c=t[Math.floor(Math.random()*t.length)];for(let t=0;t<a;t++){var l=getRandomInt(i-=.01,r),s=getRandomInt(1,4);r-=.1,s*=c,e.fillRect(n+=s,o,l,l),e.fill()}};function i(){s(e),a.forEach(t=>{t.el.pause(),t.el.removeAttribute(o)})}var c=t=>{if(!d.snow)return!1;for(var e=d.snow.ctx.canvas.width,n=d.snow.ctx.canvas.height,e=d.snow.ctx.createImageData(e,n),o=new Uint32Array(e.data.buffer),r=o.length,a=0;a<r;a++)o[a]=(255*Math.random()|0)<<24;d.snow.ctx.putImageData(e,0,0)},l=function(){c(),t(),requestAnimationFrame(l)},s=function(t){r.classList.remove(n),r.classList.remove(e),r.classList.add(t)};return{init:function(){if(r=document.querySelectorAll(".fn-videoplayer")[0],this.hasPlayed=!1,!r)return!1;document.querySelectorAll(".fn-video").forEach(t=>{a.push({el:t,url:t.src,fileName:t.getAttribute("data-file"),isPlaying:!1})}),d.snow.canvas=document.querySelector(".fn-snow"),d.snow.ctx=d.snow.canvas.getContext("2d"),d.vcr.canvas=document.querySelector(".fn-vcr"),d.vcr.ctx=d.vcr.canvas.getContext("2d"),l()},playItem:function(e){i(),this.hasPlayed=!0,hasPlayed=!0,gtag("event","watch_video",{app_name:"vitrinekast",source:e});var t=a.find(t=>t.fileName===e);t&&(t.el.play(),t.el.setAttribute(o,!0),s(n))},stopAllItems:i}}();function getRandomInt(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}var tvItemController=function(){const e=5e3;let n=!1,o=[],r=0;function a(){o.forEach(t=>{t.classList.remove("active")})}function i(t){v(),screenController.playItem(this.getAttribute("data-video"))}function c(t){t.preventDefault(),v(),document.body.removeAttribute("footer-visible");var e=t.target.getAttribute("href");""!==e&&null!==e&&window.setTimeout(function(){document.body.querySelector(".fn-tv-footer").href=t.target.getAttribute("href"),document.body.querySelector(".fn-project-name").textContent=t.target.textContent,document.body.setAttribute("footer-visible",!0)},100),screenController.playItem(t.target.getAttribute("data-video")),document.body.addEventListener("click",m,!0)}function l(t){d(forceStop=!0)}var s,u,v=function(){a(),s.removeAttribute("active"),n=window.clearInterval(n)},d=function(t=!1){r=0,n||t?(v(),screenController.stopAllItems()):(s.setAttribute("active",!0),f(),n=window.setInterval(()=>{f()},e))},f=function(){a();var t=o[r];t.classList.add("active"),screenController.playItem(t.getAttribute("data-video")),r===o.length-1?r=0:r++},m=function(){document.body.setAttribute("footer-visible",!1),d(forceStop=!0),document.body.removeEventListener("click",m,!0)};return{init:function(){u=utils.isTouchDevice(),document.body.querySelector(".fn-tv-footer"),document.querySelectorAll(".fn-tv-link").forEach(t=>{u?t.addEventListener("click",c):(t.addEventListener("mouseenter",i),t.addEventListener("mouseleave",l)),o.push(t)}),(s=document.querySelector(".fn-video-loop")).addEventListener("click",function(t){t.preventDefault(),d(),gtag("event","watch_video",{app_name:"vitrinekast",source:"toggle_timer"})}),window.setTimeout(function(){screenController.hasPlayed||(d(),gtag("event","watch_video",{app_name:"vitrinekast",source:"timeout_autoplay"}))},5e3)}}}(),utils={isTouchDevice:function(){return"ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints}};window.onload=function(){screenController.init(),tvItemController.init(),document.body.classList.add("js-loaded")};